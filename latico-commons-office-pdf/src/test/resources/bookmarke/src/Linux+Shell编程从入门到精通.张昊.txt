目　录 9
第1章　第一个Shell程序　1
1.1　第一道菜　2
1.2　如何运行程序　2
1.2.1　选婿：位于第一行的　2
1.2.2　找茬：程序执行的差异　4
1.2.3　shell的命令种类　4
1.3　Linux Shell的变量　6
1.3.1　变量　6
1.3.2　用echo输出变量　8
1.3.3　环境变量的相关操作　9
1.3.4　shell中一些常用环境变量　12
1.4　Linux Shell是解释型语言　12
1.4.1　编译型语言与解释型语言　12
1.4.2　Linux Shell编程的优势　13
1.5　小结　14
第2章　Shell编程基础　15
2.1　向脚本传递参数　16
2.1.1　Shell脚本的参数　16
2.1.2　参数的用途　17
2.2　I/O重定向　20
2.2.1　标准输入、标准输出与标准错误　20
2.2.2　管道与重定向　22
2.2.3　文件描述符　23
2.2.4　特殊文件的妙用　24
2.3　基本文本检索　28
2.4　UNIX/Linux系统的设计与shell 编程　31
2.4.1　一切皆文件　31
2.4.2　UNIX编程的基本原则　34
2.5　小结　37
第3章　编程的基本元素　39
3.1　再识变量　40
3.1.1　用户变量　41
3.1.2　位置变量　46
3.1.3　环境变量　48
3.1.4　启动文件　49
3.2　函数　51
3.2.1　函数定义　52
3.2.2　函数的参数和返回值　53
3.3　条件控制与流程控制　54
3.3.1　if/else语句　54
3.3.2　退出状态　54
3.3.3　退出状态与逻辑操作　56
3.3.4　条件测试　56
3.4　循环控制　61
3.4.1　for循环　61
3.4.2　while/until循环　62
3.4.3　跳出循环　63
3.4.4　循环实例　63
3.5　小结　65
第4章　正则表达式　66
4.1　什么是正则表达式　67
4.1.1　正则表达式的广泛应用　67
4.1.2　如何学习正则表达式　67
4.1.3　如何实践正则表达式　68
4.2　正则基础　69
4.2.1　元字符　69
4.2.2　单个字符　72
4.2.3　单个表达式匹配多个字符　73
4.2.4　文本匹配锚点　74
4.2.5　运算符优先级　74
4.2.6　更多差异　75
4.3　正则表达式的应用　76
4.3.1　扩展　76
4.3.2　案例研究：罗马数字　77
4.3.3　案例研究：解析电话号码　82
4.4　小结　86
第5章　基本文本处理　87
5.1　排序文本　88
5.1.1　sort命令的行排序　90
5.1.2　sort命令的字段排序　92
5.1.3　sort小结　93
5.2　文本去重　94
5.3　统计文本行数、字数以及字 符数　96
5.4　打印和格式化输出　97
5.4.1　使用pr打印文件　97
5.4.2　使用fmt命令格式化文本　99
5.4.3　使用fold限制文本宽度　101
5.5　提取文本开头和结尾　102
5.6　字段处理　104
5.6.1　字段的使用案例　104
5.6.2　使用cut取出字段　105
5.6.3　使用join连接字段　107
5.6.4　其他字段处理方法　110
5.7　文本替换　110
5.7.1　使用tr替换字符　110
5.7.2　其他选择　113
5.8　一个稍微复杂的例子　114
5.8.1　实例描述　114
5.8.2　取出记录的ip字段和id字段　114
5.8.3　将记录按照IP顺序排序　115
5.8.4　使用uniq统计重复IP　115
5.8.5　根据访问次数进行排序　116
5.8.6　提取出现次数最多的100条　116
5.9　小结　117
第6章　文件和文件系统　118
6.1　文件　119
6.1.1　列出文件　119
6.1.2　文件的类型　122
6.1.3　文件的权限　123
6.1.4　文件的修改时间　131
6.2　寻找文件　133
6.2.1　find命令的参数　133
6.2.2　遍历文件　137
6.3　比较文件　138
6.3.1　使用comm比较排序后文件　138
6.3.2　使用diff比较文件　139
6.3.3　其他文本比较方法　141
6.4　文件系统　142
6.4.1　什么是文件系统　143
6.4.2　文件系统与磁盘分区　143
6.4.3　Linux分区格式的选择与安全性　145
6.4.4　文件系统与目录树　147
6.4.5　文件系统的创建与挂载　151
6.5　小结　154
第7章　流编辑　155
7.1　什么是sed　156
7.1.1　挑选编辑器　156
7.1.2　sed的版本　156
7.2　sed示例　156
7.2.1　sed的工作方式　156
7.2.2　sed工作的地址范围　158
7.2.3　规则表达式　159
7.3　更强大的sed功能　161
7.3.1　替换　162
7.3.2　地址范围的迷惑　163
7.4　组合命令　164
7.4.1　组合多条命令　164
7.4.2　将多条命令应用到一个地址范围　166
7.5　实际的例子　166
7.6　sed实践　167
7.6.1　第一步 替换名字　168
7.6.2　第二步 删除前3行　168
7.6.3　第三步 显示5～10行　169
7.6.4　第四步 删除包含Lane的行　169
7.6.5　第五步 显示生日在November-December之间的行　170
7.6.6　第六步 把3个星号(***)添加到以Fred开头的行　170
7.6.7　第七步 用JOSE HASRETIRED取代包含Jose的行　171
7.6.8　第八步 把Popeye的生日改成11/14/46　172
7.6.9　第九步 删除所有空白行　173
7.6.10　第十步 脚本　174
7.7　小结　175
第8章　文本处理利器awk　176
8.1　来个案例　177
8.2　基本语法　178
8.2.1　多个字段　178
8.2.2　使用其他字段分隔符　179
8.3　AWK语言特性　181
8.3.1　AWK代码结构　181
8.3.2　变量与数组　184
8.3.3　算术运算和运算符　186
8.3.4　判断与循环　188
8.3.5　多条记录　192
8.4　用户自定义函数　194
8.4.1　自定义函数格式　194
8.4.2　引用传递和值传递　196
8.4.3　递归调用　197
8.5　字符串与算术处理　199
8.5.1　格式化输出　199
8.5.2　字符串函数　201
8.5.3　算术函数　206
8.6　案例分析　210
8.6.1　生成数据报表　210
8.6.2　多文件联合处理　212
8.6.3　检验passwd格式的正确性　214
8.6.4　sed/awk单行脚本　215
8.7　小结　222
第9章　进程　223
9.1　进程的含义与查看　224
9.1.1　理解进程　224
9.1.2　创建进程　224
9.1.3　查看进程　225
9.1.4　进程的属性　229
9.2　进程管理　230
9.2.1　进程的状态　230
9.2.2　shell命令的执行　232
9.2.3　进程与任务调度　233
9.3　信号　239
9.3.1　信号的基本概念　239
9.3.2　产生信号　242
9.4　Linux的第一个进程init　244
9.5　案例分析：Linux系统中管道的 实现　247
9.6　调度系统任务　249
9.6.1　任务调度的基本介绍　249
9.6.2　调度重复性系统任务(cron)　250
9.6.3　使用at命令　256
9.7　进程的窗口/proc　259
9.7.1　proc——虚拟文件系统　260
9.7.2　查看/proc的文件　260
9.7.3　从proc获取信息　261
9.7.4　通过/proc与内核交互　263
9.8　Linux的线程简介　264
9.8.1　Linux线程的定义　264
9.8.2　Pthread线程的使用场合　264
9.8.3　Linux进程和线程的发展　265
9.9　小结　265
第10章　超级工具　267
10.1　不同的shell　268
10.1.1　修改登录shell和切换shell　268
10.1.2　选择shell　270
10.2　SSH　273
10.2.1　SSH的安全验证机制　273
10.2.2　使用SSH登录远程 主机　274
10.2.3　OpenSSH密钥管理　276
10.2.4　 配置SSH　281
10.2.5　使用SSH工具套装拷贝文件　282
10.3　screen工具　283
10.3.1　任务退出的元凶：SIGHUP信号　284
10.3.2　开始使用screen　285
10.3.3　screen常用选项　287
10.3.4　实例：ssh+screen管理远程会话　289
10.4　文本编辑工具Vim　289
10.4.1　为什么选择Vim　290
10.4.2　从何处获取Vim　290
10.4.3　Vim的工作模式　292
10.4.4　首次接触：step by step　293
10.4.5　鼠标的移动　294
10.4.6　基本编辑指令　295
10.4.7　复制(yank)　299
10.4.8　搜寻、替换　301
10.5　小结　303
第11章　Linux Shell编程实战　304
11.1　日志清理　305
11.1.1　程序行为介绍　305
11.1.2　准备函数　305
11.1.3　日志备份函数　309
11.1.4　定时运行　310
11.1.5　代码回顾　311
11.2　系统监控　312
11.2.1　内存监控函数　313
11.2.2　硬盘空间监控函数　314
11.2.3　CPU占用监控函数　315
11.2.4　获取最忙碌的进程信息　319
11.2.5　结合到一起　320
11.2.6　代码回顾　320
11.3　小结　322