目录 8

第1章　Spring Cloud概述                                                         12
	1.1 传统的应用                                                                  13
			1.1.1 单体应用                                                                  13
		1.1.2 架构演进                                                                  14
		1.1.3 架构要求                                                                  15
	1.2 微服务与Spring Cloud                                                        16
		1.2.1 什么是微服务                                                              16
			1.2.2 关于Netflix OSSS                                                          17
		1.2.3 Spring Cloud与Netflix                                                     17
		1.2.4 Spring Cloud 的主要模块                                                   17
	1.3 学习方面的准备工作                                                          18
		1.3.1 下载本书的软件及源码                                                      18
		1.3.2 导入本书的案例                                                            18
	1.4 本章小结                                                                    19
第2章　搭建开发环境                                                             20
	2.1 安装与配置Maven                                                             21
		2.1.1关于Maven                                                                  21
		2.1.2 下载与安装Maven                                                           22
		2.1.3 配置远程仓库                                                              22
	2.2 安装Eclipse                                                                 23
		2.2.1 Eclipse版本                                                               23
		2.2.2 在Eclipse中配置Maven                                                      23
	2.3 Spring Boot                                                                 24
		2.3.1 Spring Boot简介                                                           24
		2.3.2 新建Maven项目                                                             25
		2.3.3 编写启动类                                                                26
		2.3.4 编写控制器                                                                27
		2.3.5 发布RESTWebService                                                        28
	2.4 Spring Boot的配置文件                                                       29
		2.4.1 默认配置文件                                                              29
		2.4.2 指定配置文件位置                                                          30
		2.4.3 YML文件                                                                   30
		2.4.4 运行时指定profiles配置                                                    31
		2.4.5 热部署                                                                    31
	2.5 Spring Cloud的版本                                                          32
	2.6 本章小结                                                                    32
第3章　微服务发布与调用                                                         33
	3.1 Eureka介绍                                                                  34
		3.1.1 关于Eureka                                                                34
		3.1.2 Eureka架构                                                                34
		3.1.3 服务器端                                                                  35
		3.1.4 服务提供者                                                                35
		3.1.5 服务调用者                                                                35
	3.2 第一个Eureka应用                                                            35
		3.2.1 构建服务器                                                                35
		3.2.2 服务器注册开关                                                            38
		3.2.3 编写服务提供者                                                            38
		3.2.4 编写服务调用者                                                            40
		3.2.5 程序结构                                                                  43
	3.3 Eureka集群搭建                                                              44
		3.3.1 本例集群结构图                                                            44
		3.3.2 改造服务器端                                                              45
		3.3.3 改造服务提供者                                                            46
		3.3.4 改造服务调用者                                                            48
		3.3.5 编写REST客户端进行测试                                                    48
	3.4 服务实例的健康自检                                                          49
		3.4.1 程序结构                                                                  50
		3.4.2 使用Spring Boot Actuator                                                  50
		3.4.3 实现应用健康自检                                                          50
		3.4.4 服务查询                                                                  53
	3.5 Eureka的常用配置                                                            55
		3.5.1 心跳检测配置                                                              55
		3.5.2 注册表抓取间隔                                                            55
		3.5.3 配置与使用元数据                                                          56
		3.5.4 自我保模式                                                                56
	3.6 本章小结                                                                    57
第4章　负载均衡                                                                 58
	4.1 Ribbon介绍                                                                  59
		4.1.1 Ribbon简介                                                                59
		4.1.2 Ribbon子模块                                                              59
		4.1.3 负载均衡器组件                                                            59
	4.2 第一个Ribbon程序                                                            60
		4.2.1 编写服务                                                                  60
		4.2.2 编写请求客户端                                                            62
		4.2.3 Ribbon的配置                                                              63
	4.3 Ribbon的负载均衡机制                                                        64
		4.3.1负载均衡器                                                                 64
		4.3.2 自定义负载规则                                                            65
		4.3.3 Ribbon自带的负载规则                                                      67
		4.3.4 Pingg机制                                                                 68
		4.3.5 自定义Ping                                                                70
		4.3.6 其他配置                                                                  70
	4.4 在Spring Cloud中使用Ribbon                                                  70
		4.4.1 准备工作                                                                  71
		4.4.2 使用代码配置Ribbon                                                        72
		4.4.3 使用配置文件设置Ribbon                                                    74
		4.4.4 Spring使用Ribbon的API                                                     75
	4.5 RestTemplate负载均衡                                                        77
		4.5.1 @LoadBalanced注解概述                                                     77
		4.5.2编写自定义注解以及拦截器                                                   77
		4.5.3 使用自定义拦截器以及注解                                                  79
		4.5.4 在控制器中使用RestTemplate                                                80
	4.6 本章小结                                                                    82
第5章　REST客户端Feign                                                          83
	5.1 REST客户端                                                                  84
		5.1.1 使用CXF调用REST服务                                                       84
		5.1.2 使用Restlet调用REST服务                                                   85
		5.1.3 Feign框架介绍                                                             86
		5.1.4第一个Feign程序                                                            87
		5.1.5 请求参数与返回对象                                                        88
	5.2 使用Feign                                                                   89
		5.2.1 编码器                                                                    90
		5.2.2 解码器                                                                    91
		5.2.3 XML的编码与解码                                                           91
		5.2.4 自定义编码器与解码器                                                      94
		5.2.5 自定义Feign客户端                                                         94
		5.2.6 使用第三方注解                                                            96
		5.2.7 Feign解析第三方注解                                                       97
		5.2.8 请求拦截器                                                                100
		5.2.9 接口日志                                                                  100
	5.3 在Spring Cloud中使用Feign                                                   101
		5.3.1 Spring Cloud整合Feign                                                     102
		5.3.2 Feign负载均衡                                                             104
		5.3.3默认配置                                                                   104
		5.3.4 自定义配置                                                                105
		5.3.5 可选配置                                                                  108
		5.3.6 压缩配置                                                                  109
	5.4 本章小结                                                                    109
第6章　Spring Cloud的保护机制                                                   110
	6.1 概述                                                                        111
		6.1.1 实际问题                                                                  111
		6.1.2 传统的解决方式                                                            112
		6.1.3 集群容错框架Hystrix                                                       112
		6.1.4 Hystrix的功能                                                             113
	6.2 第一个Hystrix程序                                                           114
		6.2.1 准备工作                                                                  114
		6.2.2 客户端使用Hystrix                                                         114
		6.2.3 调用错误服务                                                              116
		6.2.4 Hystrix的运作流程                                                         117
	6.3 Hystrix的使用                                                               119
		6.3.1 命令执行                                                                  119
		6.3.2 属性配置                                                                  121
		6.3.3 回退                                                                      122
		6.3.4 回退的模式                                                                123
		6.3.5 断路器开启                                                                124
		6.3.6 断路器关闭                                                                127
		6.3.7 隔离机制                                                                  129
		6.3.8 合并请求                                                                  132
		6.3.9 请求缓存                                                                  136
	6.4 在Spring Cloud中使用Hystrix                                                 138
		6.4.1 整合Hystrix                                                               139
		6.4.2 命令配置                                                                  141
		6.4.3 默认配置                                                                  142
		6.4.4 缓存注解                                                                  143
		6.4.5 合并请求注解                                                              145
		6.4.6 Feign与Hystrix整合                                                        147
		6.4.7 Hystrix监控                                                               151
	6.5 本章小结                                                                    153
第7章　微服务集群网关                                                           154
	7.1 Zuul框架介绍                                                                155
		7.1.1 关于Zuul                                                                  155
		7.1.2 Zuul的功能                                                                155
	7.2在Web项目中使用Z u u l                                                       156
		7.2.1 Web项目整合Zuul                                                           156
		7.2.2 测路由功能                                                                156
		7.2.3 过滤器运行机制                                                            158
	7.3 在微服务集群中初试Zuul                                                      159
		7.3.1 集群搭建                                                                  160
		7.3.2 路由到集群服务                                                            161
		7.3.3 Zuul Http客户端                                                           164
	7.4 路由配置                                                                    164
		7.4.1 简单路由                                                                  165
		7.4.2 跳转路由                                                                  166
		7.4.3 Ribbon路由                                                                166
		7.4.4 自定义路由规则                                                            167
		7.4.5 忽略路由                                                                  168
	7.5 Zuul的其他配置                                                              168
		7.5.1 请求头配置                                                                168
		7.5.2 路由端点                                                                  169
		7.5.3 Zuul与Hystrix                                                             169
		7.5.4 Zuul中预加载Ribbon                                                        172
	7.6 Zuul功能进阶                                                                172
		7.6.1 过滤器优先级                                                              172
		7.6.2 自定义过滤器                                                              173
		7.6.3 动态加载过滤器                                                            174
		7.6.4 禁用过滤器                                                                176
		7.6.5 请求上下文                                                                177
		7.6.6 @EnableZuulServer注解                                                     179
		7.6.7 error过滤器                                                               180
		7.6.8 态路由                                                                    182
	7.7 本章小结                                                                    183
第8章　微服务与消息驱动                                                         184
	8.1 Spring Cloud Stream介绍                                                     185
		8.1.1 关于Stream框架                                                            185
		8.1.2 Stream框架的组成部分                                                      185
		8.1.3 消息代理中间件                                                            185
	8.2 RabbitMQ框架                                                                186
		8.2.1 RabbitMQ和AMQP                                                            186
		8.2.2 下载与运行                                                                187
		8.2.3 编写生产者                                                                188
		8.2.4 编写消费者                                                                190
		8.2.5 交换器、绑定与队列                                                        191
	8.3 Apache Kafka框架                                                            192
		8.3.1 关于Kafka                                                                 192
		8.3.2 运行Kafka服务器                                                           193
		8.3.3 编写生产者                                                                193
		8.3.4 编写消费者                                                                195
		8.3.5 消费者组                                                                  196
	8.4 开发消息微服务                                                              196
		8.4.1 准备工作                                                                  197
		8.4.2 编写生产者                                                                198
		8.4.3 编写消费者                                                                199
		8.4.4 更换绑定器                                                                200
		8.4.5 Sink、Source与Processor                                                   201
		8.4.6 消费者组                                                                  202
	8.5 本章小结                                                                    203
第9章　集群配置中心                                                             204
	9.1 概述                                                                        205
		9.1.1 关于Spring Cloud Config                                                   205
		9.1.2 应用结构                                                                  206
		9.1.4 搭建SVN环境                                                               207
		9.1.3 引导程序简介                                                              206
	9.2 构建第一个例子                                                              207
		9.2.1 创建服务器                                                                207
		9.2.2 配置SVN仓库                                                               208
		9.2.3 创建客户端                                                                210
		9.2.4 从客户端读取SVN配置                                                       211
		9.2.5 目录配置总结                                                              212
		9.2.6 刷新配置                                                                  213
		9.2.7 刷新Bean                                                                  214
	9.3 配置的加密和解密                                                            216
		9.3.1 为服务器安装JCE                                                           216
		9.3.2 加密和解密端点                                                            216
		9.3.3 SVN存储加密数据                                                           217
		9.3.4 非对称加密                                                                218
	9.4 其他配置                                                                    218
		9.4.1 服务器健康指示器                                                          218
		9.4.2 客户端的错误提前与重试机制                                                219
		9.4.3 安全配置                                                                  220
		9.4.4 访问服务器配置                                                            221
	9.5 整合使用                                                                    221
		9.5.1 准备工作                                                                  221
		9.5.2 配置服务器、客户端整合Eureka                                              223
		9.5.3 整合Zuul                                                                  225
		9.5.4 整合Spring Cloud Bus刷新配置                                              227
		9.5.5 刷新单个节点配置                                                          228
	9.6 本章结                                                                      228
第10章　微服务跟踪                                                              230
	10.1 概述                                                                       231
		10.1.1 实际问题与Sleuth                                                         231
		10.1.2 服务跟踪系统                                                             231
		10.1.3 Sleuth的基本概念                                                         232
		10.1.4 项目准备                                                                 232
	10.2 Sleuth整合Zipkin                                                           233
		10.2.1 Zipkin简介                                                               233
		10.2.2 构建Z i p kin服务器项目                                                  234
		10.2.3 配置微服务                                                               235
		10.2.4 查看数据                                                                 236
		10.2.5 使用MySQL保存数据                                                        239
		10.2.6 使用消息采集数据                                                         241
	10.3 Sleuth整合ELK                                                              243
		10.3.1 关于ELK                                                                  243
		10.3.2 下载ELK                                                                  244
		10.3.3 运行Elasticsearch                                                        244
		10.3.4 使用Logstash读取JSON                                                     245
		10.3.5 使用Kibana展示数据                                                       246
		10.3.6 使用Logback转换JSON                                                      248
	10.4 本章小结                                                                   251
第11章　微服务数据库实战                                                        252
	11.1 概述                                                                       253
		11.1.1 关于Spring Data                                                          253
		11.1.2 Spring Data的功能                                                        254
		11.1.3 Spring Data的模块                                                        254
	11.2 Spring Data与JPA                                                           254
		11.2.1 构建项目                                                                 255
		11.2.2 数据访问层与业务层                                                       256
		11.2.3 自定义数据存储逻辑                                                       258
		11.2.4 方法名查询                                                               259
		11.2.5 使用＠Query注解                                                          260
	11.3 Spring Data与MongoDB                                                       261
		11.3.1 安装MongoDB                                                              261
		11.3.2 配置权限                                                                 262
		11.3.3 MongoDB的概念                                                            263
		11.3.4 构建项目                                                                 263
		11.3.5 数据访问层与业务层                                                       264
		11.3.6 自定义数据存储逻辑                                                       265
		11.3.7 方法名查询                                                               267
		11.3.8 使用＠Query注解                                                          269
	11.4 Spring Data与Redis                                                         269
		11.4.1 Redis的安装与配置                                                        269
		11.4.2 Redis的数据类型                                                          270
		11.4.3 使用Jedis                                                                271
		11.4.4 构建Spring Data项目                                                      273
		11.4.5 数据访问层与业务层                                                       274
		11.4.6 自定义数据存储逻辑                                                       276
		11.4.7 方法名查询                                                               278
	11.5 本章小结                                                                   279
第12章　案例实战                                                                280
	12.1 概述                                                                       281
		12.1.1 表现层技术                                                               281
		12.1.2 案例概述                                                                 281
		12.1.3 案例技术选型                                                             281
	12.2 Spring Boot与JSP                                                           282
		12.2.1 构建项目                                                                 282
		12.2.2 配置                                                                     283
		12.2.3 打包部署                                                                 284
	12.3 模板引擎Thymeleaf                                                          285
		12.3.1 关于Thymeleaf                                                            285
		12.3.2 Spring B o o t整合Thymeleaf                                              285
		12.3.3 加载资源                                                                 286
		12.3.4 获取请求数据                                                             287
		12.3.5 调用Bean方法                                                             287
		12.3.6 遍历集合                                                                 288
			12.3.7 表单提交                                                                 288
	12.4 图书管理案例                                                               289
		12.4.1 运行案例                                                                 289
		12.4.2 案例模块                                                                 290
		12.4.4 数据库                                                                   291
		12.4.6 新建图书                                                                 295
		12.4.7 图书展示                                                                 297
		12.4.5 用户登录                                                                 291
		12.4.3 案例架构                                                                 290
	12.5 本章小结                                                                   298
