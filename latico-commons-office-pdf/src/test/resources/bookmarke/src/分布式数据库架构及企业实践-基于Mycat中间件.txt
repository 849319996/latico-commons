
封面                                                                            1
内容简介                                                                        2
前言                                                                            7
目录                                                                            10
第1章 数据库中间件与分布式数据库的实现                                          16
	1.1 什么是分布式系统                                                            16
	1.2 为什么需要分布式数据库                                                      17
	1.3 分布式数据库的实现原理                                                      18
	1.4 Mycat 数据库中间件简介                                                      20
		1.4.1 Mycat 的历史与未来规划                                                    20
		1.4.2 Mycat 与其他中间件的区别                                                  23
		1.4.3 Mycat 的优势                                                              25
		1.4.4 Mycat 的适用场合                                                          25
第2章 Mycat 入门                                                                28
	2.1 环境搭建                                                                    28
		2.1.1 Windows 环境搭建                                                          28
		2.1.2 Linux 环境搭建                                                            30
	2.2 Mycat 核心概念详解                                                          31
		2.2.1 逻辑库（schema）                                                          31
		2.2.2 逻辑表（table）                                                           31
		2.2.3 分片节点（dataNode）                                                      32
		2.2.4 节点主机（dataHost）                                                      32
	2.3 Mycat 原理介绍                                                              33
	2.4 参与 Mycat 源码开发                                                         34
		2.4.1 Mycat 源码环境搭建                                                        34
		2.4.2 Mycat 源码调试                                                            34
第3章 Mycat 进阶                                                                37
	3.1 Mycat 配置详解                                                              37
		3.1.1 Mycat 支持的两种配置方式                                                  37
		3.1.2 server.xml 配置文件                                                       38
		3.1.3 schema.xml 配置文件                                                       43
		3.1.4 sequence 配置文件                                                         52
		3.1.5 zk-create.yaml 配置文件                                                   56
		3.1.6 其他配置文件                                                              59
	3.2 Mycat 分片规则详解                                                          60
		3.2.1 分片表与非分片表                                                          61
		3.2.2 ER 关系分片表                                                             61
		3.2.3 分片规则 rule.xml 文件详解                                                61
		3.2.4 取模分片                                                                  62
		3.2.5 枚举分片                                                                  63
		3.2.6 范围分片                                                                  63
		3.2.7 范围求模算法                                                              64
		3.2.8 固定分片 hash 算法                                                        65
		3.2.9 取模范围算法                                                              66
		3.2.10 字符串 hash 求模范围算法                                                 67
		3.2.11 应用指定的算法                                                           69
		3.2.12 字符串 hash 解析算法                                                     69
		3.2.13 一致性 hash 算法                                                         70
		3.2.14 按日期（天）分片算法                                                     71
		3.2.15 按单月小时算法                                                           72
		3.2.16 自然月分片算法                                                           73
		3.2.17 日期范围 hash 算法                                                       73
	3.3 Mycat 管理命令详解                                                          74
		3.3.1 Reload 命令                                                               76
		3.3.2 Show 命令                                                                 76
第4章 Mycat 高级技术实战                                                        83
	4.1 用 Mycat 搭建读写分离                                                       83
		4.1.1 MySQL 读写分离                                                            84
		4.1.2 MySQL Galera Cluster 读写分离                                             88
		4.1.3 SQL Server 读写分离                                                       98
	4.2 Mycat 故障切换                                                              101
		4.2.1 Mycat 主从切换                                                            101
		4.2.2 MySQL Galera 节点切换                                                     114
	4.3 Mycat+Percona+HAProxy+Keepalived                                            128
		4.3.1 Mycat                                                                     128
		4.3.2 Percona 集群                                                              139
		4.3.3 HAProxy                                                                   146
		4.3.4 Keepalived                                                                153
	4.4 MHA+Keepalived 集群搭建                                                     155
		4.4.1 配置 MySQL 半同步方式                                                     157
		4.4.2 安装配置 MHA                                                              165
		4.4.3 测试重构                                                                  168
		4.4.4 扩展 Keepalived                                                           170
	4.5 用 ZooKeeper 搭建 Mycat 高可用集群                                          173
		4.5.1 ZooKeeper 概述                                                            173
		4.5.2 ZooKeeper 的运用场景                                                      176
		4.5.3 ZooKeeper 在 Mycat 中的使用                                               178
	4.6 Mycat 高可用配置                                                            180
	4.7 Mycat 注解技术                                                              185
		4.7.1 balance 注解实战                                                          185
		4.7.2 master/slave 注解实战                                                     187
		4.7.3 SQL 注解实战                                                              188
		4.7.4 schema 注解实战                                                           191
		4.7.5 dataNode 注解实战                                                         191
		4.7.6 catlet 注解实战                                                           192
第5章 Mycat 企业运维                                                            194
	5.1 Mycat 性能监控--Mycat-web 详解                                              194
		5.1.1 Mycat-web 简介                                                            194
		5.1.2 Mycat-web 的配置和使用                                                    195
		5.1.3 Mycat 性能监控指标                                                        196
	5.2 Mycat 性能优化                                                              198
	5.3 MySQL 优化技术                                                              201
		5.3.1 数据库建表设计规范                                                        201
		5.3.2 SQL 语句与索引                                                            210
		5.3.3 配置文件                                                                  221
		5.3.4 InnoDB 选择文件系统                                                       227
		5.3.5 系统架构                                                                  228
第6章 Mycat 架构剖析                                                            230
	6.1 Mycat 总体架构介绍                                                          230
	6.2 Mycat 网络 I/O 架构与实现                                                   233
		6.2.1 Mycat I/O 架构概述                                                        233
		6.2.2 前端通信框架                                                              236
	6.3 Mycat 线程架构与实现                                                        239
		6.3.1 多线程基础                                                                239
		6.3.2 Mycat 线程架构                                                            241
	6.4 Mycat 内存管理及缓存架构与实现                                              243
		6.4.1 Mycat 内存管理                                                            244
		6.4.2 Mycat 缓存架构与实现                                                      246
	6.5 Mycat 连接池架构与实现                                                      247
		6.5.1 Mycat 连接池                                                              247
		6.5.2 Mycat 连接池架构及代码实现                                                249
	6.6 Mycat 主从切换架构与实现                                                    250
		6.6.1 Mycat 主从切换概述                                                        250
		6.6.2 Mycat 主从切换的实现                                                      253
第7章 Mycat 核心技术分析                                                        256
	7.1 Mycat 分布式事务的实现                                                      256
		7.1.1 XA 规范                                                                   256
		7.1.2 二阶段提交                                                                257
		7.1.3 三阶段提交                                                                258
		7.1.4 Mycat 中分布式事务的实现                                                  259
	7.2 Mycat SQL 路由的实现                                                        264
		7.2.1 路由的作用                                                                264
		7.2.2 SQL 解析器                                                                265
		7.2.3 路由计算                                                                  267
	7.3 Mycat 跨库 Join 的实现                                                      275
		7.3.1 全局表                                                                    275
		7.3.2 ER 分片                                                                   276
		7.3.3 catlet                                                                    277
		7.3.4 ShareJoin                                                                 279
	7.4 Mycat 数据汇聚和排序的实现                                                  285
		7.4.1 数据排序                                                                  285
		7.4.2 数据汇聚                                                                  288
第8章 Mycat多数据库支持原理与实现                                               289
	8.1 MySQL 协议在 Mycat 中的实现                                                 290
		8.1.1 MySQL 协议概述                                                            290
		8.1.2 Mycat 的 MySQL 协议实现                                                   298
	8.2 PostgreSQL 协议在 Mycat 中的实现                                            302
		8.2.1 PostgreSQL 介绍                                                           302
		8.2.2 PostgreSQL 协议                                                           303
		8.2.3 PostgreSQL 实现                                                           308
	8.3 Mycat 对 JDBC 支持的实现                                                    313
		8.3.1 Oracle 配置                                                               314
		8.3.2 SQL Server 配置                                                           315
		8.3.3 MongoDB 配置                                                              315
		8.3.4 源码分析                                                                  321
