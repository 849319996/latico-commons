目录 2
基 础 篇 8
第1章 安装与配置基础                                                            9
	1.1 初识PostgreSQL                                                              9
		1.1.1 PostgreSQL的特点                                                          10
		1.1.2 许可                                                                      10
		1.1.3 邮件列表和讨论区                                                          10
	1.2 安装PostgreSQL                                                              10
		1.2.1 通过yum源安装                                                             11
		1.2.2 通过源码编译安装                                                          12
		1.2.3 设置一个软链接                                                            14
	1.3 客户端程序和服务器程序                                                      15
		1.3.1 客户端程序                                                                15
		1.3.2 服务器程序                                                                18
	1.4 创建数据库实例                                                              18
		1.4.1 创建操作系统用户                                                          18
		1.4.2 创建数据目录                                                              19
		1.4.3 初始化数据目录                                                            20
	1.5 启动和停止数据库服务器                                                      21
		1.5.1 使用service方式                                                           22
		1.5.2 使用pg_ctl进行管理                                                        22
		1.5.3 其他启动和关闭数据库服务器的方式                                          23
		1.5.4 配置开机启动                                                              23
	1.6 数据库配置基础                                                              24
		1.6.1 配置文件的位置                                                            24
		1.6.2 pg_hba.conf                                                               24
		1.6.3 postgresql.conf                                                           26
		1.6.4 允许远程访问数据库                                                        27
	1.7 本章小结                                                                    29
第2章 客户端工具                                                                30
	2.1 pgAdmin 4简介                                                               30
		2.1.1 pgAdmin 4 安装                                                            30
		2.1.2 pgAdmin 4 使用                                                            30
	2.2 psql功能及应用                                                              33
		2.2.1 使用psql连接数据库                                                        33
		2.2.2 psql元命令介绍                                                            35
		2.2.3 psql导入、导出表数据                                                      38
		2.2.4 psql的语法和选项介绍                                                      41
		2.2.5 psql执行sql脚本                                                           43
		2.2.6 psql如何传递变量到SQL                                                     44
		2.2.7 使用psql定制日常维护脚本                                                  45
		2.2.8 psql亮点功能                                                              46
	2.3 本章小结                                                                    50
第3章 数据类型                                                                  51
	3.1 数字类型                                                                    51
		3.1.1 数字类型列表                                                              51
		3.1.2 数字类型操作符和数学函数                                                  53
	3.2 字符类型                                                                    54
		3.2.1 字符类型列表                                                              54
		3.2.2 字符类型函数                                                              55
	3.3 时间/日期类型                                                               56
		3.3.1 时间/日期类型列表                                                         56
		3.3.2 时间/日期类型操作符                                                       57
		3.3.3 时间/日期类型常用函数                                                     58
	3.4 布尔类型                                                                    59
	3.5 网络地址类型                                                                60
		3.5.1 网络地址类型列表                                                          61
		3.5.2 网络地址操作符                                                            62
		3.5.3 网络地址函数                                                              63
	3.6 数组类型                                                                    63
		3.6.1 数组类型定义                                                              63
		3.6.2 数组类型值输入                                                            63
		3.6.3 查询数组元素                                                              64
		3.6.4 数组元素的追加、删除、更新                                                65
		3.6.5 数组操作符                                                                65
		3.6.6 数组函数                                                                  66
	3.7 范围类型                                                                    67
		3.7.1 范围类型列表                                                              67
		3.7.2 范围类型边界                                                              68
		3.7.3 范围类型操作符                                                            69
		3.7.4 范围类型函数                                                              69
		3.7.5 给范围类型创建索引                                                        70
	3.8 json/jsonb类型                                                              70
		3.8.1 json类型简介                                                              70
		3.8.2 查询json数据                                                              71
		3.8.3 jsonb与json差异                                                           71
		3.8.4 jsonb与json操作符                                                         72
		3.8.5 jsonb与json函数                                                           73
		3.8.6 jsonb键/值的追加、删除、更新                                              73
	3.9 数据类型转换                                                                75
		3.9.1 通过格式化函数进行转换                                                    75
		3.9.2 通过CAST函数进行转换                                                      75
		3.9.3 通过::操作符进行转换                                                      76
	3.10 本章小结                                                                   77
第4章 SQL高级特性                                                               78
	4.1 WITH查询                                                                    78
		4.1.1 复杂查询使用CTE                                                           78
		4.1.2 递归查询使用CTE                                                           79
	4.2 批量插入                                                                    81
		4.2.1 方式一：INSERT INTO...SELECT...                                           81
		4.2.2 方式二：INSERT INTO VALUES (),(),...()                                    82
		4.2.3 方式三：COPY或\COPY元命令                                                 82
	4.3 RETURNING返回修改的数据                                                     83
		4.3.1 RETURNING返回插入的数据                                                   83
		4.3.2 RETURNING返回更新后数据                                                   84
		4.3.3 RETURNING返回删除的数据                                                   84
	4.4 UPSERT                                                                      85
		4.4.1 UPSERT场景演示                                                            85
		4.4.2 UPSERT语法                                                                86
	4.5 数据抽样                                                                    87
		4.5.1 SYSTEM抽样方式                                                            88
		4.5.2 BERNOULLI抽样方式                                                         89
	4.6 聚合函数                                                                    91
		4.6.1 string_agg函数                                                            91
		4.6.2 array_agg函数                                                             92
	4.7 窗口函数                                                                    93
		4.7.1 窗口函数语法                                                              93
		4.7.2 avg() OVER()                                                              94
		4.7.3 row_number()                                                              95
		4.7.4 rank()                                                                    96
		4.7.5 dense_rank ()                                                             96
		4.7.6 lag()                                                                     97
		4.7.7 first_value ()                                                            98
		4.7.8 last_value ()                                                             98
		4.7.9 nth_value ()                                                              99
		4.7.10 窗口函数别名的使用                                                       99
	4.8 本章小结                                                                    100
